#!/usr/bin/env bash
#
# Download Function
# the "$DUMP" variable is reused in
# "version_" functions so there only needs
# to be 1 http request for all the data needed
download_Template()
{
	API="true"
	HTML="false"
	DUMP="$(wget -qO- "https://api.github.com/repos/$AUTHOR/$PROJECT/releases/latest")"
	if [[ $? != "0" ]]; then
		$ired; echo "GitHub API error detected..."
		$white; echo "Trying GitHub HTML filter instead..."
		DUMP="$(wget -qO- "https://github.com/$AUTHOR/$PROJECT/releases/latest")"
		API="false"
		HTML="true"
	fi
	if [[ $downloadMonero = "true" ]]; then
		LINK="https://downloads.getmonero.org/cli/linux64"
		wget -P "$tmp" -q --show-progress --content-disposition "$LINK"
		code_Wget
	else
		if [[ "$HTML" = "true" ]]; then
			LINK="$(echo "$DUMP" \
				| grep -o "/$AUTHOR/$PROJECT/releases/download/.*/$DOT_PKG" \
				| awk '{print $1}' \
				| tr -d '"' \
				| sed 's@^@https://github.com@')"
		else
			LINK="$(echo "$DUMP" \
				| grep -o "https://github.com/$AUTHOR/$PROJECT/releases/download/.*/$DOT_PKG" \
				| tr -d '"')"
		fi
		wget -P "$tmp" -q --show-progress "$LINK"
		code_Wget
	fi
}
