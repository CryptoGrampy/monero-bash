#!/bin/bash
#
#						Check "x" (used by update command)
#						for fetching internet stats
check_Price()
{
	prompt_PriceAPI_IP
	$ired; echo "XMR price: " ;$off
	wget -qO- "https://min-api.cryptocompare.com/data/price?fsym=XMR&tsyms=USD,EUR,JPY,GBP,CHF,CAD,AUD,ZAR" \
	| tr -d "{\"}" | tr "," "\n" | sed 's/:/: /g'
	echo
	$bred; echo "XMR: 1"
}

check_Template()
{
	prompt_Sudo
	error_Sudo
	version_"$NAME_FUNC"
	if [[ "$NAME_VER" != "$NAME_NEWVER" ]]; then
		$white; echo -n "$NAME_PRETTY: "
		$ired; echo -n "$NAME_VER "
		$white; echo -n "> "
		$bgreen; echo "$NAME_NEWVER"
		updateFound="true"
		sudo sed -i "s@.*"$NAME_OLD"=.*@"$NAME_OLD"=\"true\"@" "$state"
		PRODUCE_HASH_LIST &>/dev/null
	else
		$white; echo -n "$NAME_PRETTY: "
		$bgreen; echo "up to date"
	fi
}

check_Monero()
{
	NAME_FUNC="NewMonero"
	NAME_PRETTY="Monero"
	NAME_VER="$MONERO_VER"
	NAME_NEWVER="$monero_NewVer"
	NAME_OLD="MONERO_OLD"
	check_Template
}

check_MoneroBash()
{
	NAME_FUNC="NewMoneroBash"
	NAME_PRETTY="monero-bash"
	NAME_VER="$MONERO_BASH_VER"
	NAME_NEWVER="$moneroBash_NewVer"
	NAME_OLD="MONERO_BASH_OLD"
	check_Template
}

check_XMRig()
{
	NAME_FUNC="NewXMRig"
	NAME_PRETTY="XMRig"
	NAME_VER="$XMRIG_VER"
	NAME_NEWVER="$xmrig_NewVer"
	NAME_OLD="XMRIG_OLD"
	check_Template
}

check_P2Pool()
{
	NAME_FUNC="NewP2Pool"
	NAME_PRETTY="P2Pool"
	NAME_VER="$P2POOl_VER"
	NAME_NEWVER="$p2pool_NewVer"
	NAME_OLD="P2POOL_OLD"
	check_Template
}

check_Update()
{
	check_MoneroBash
	[[ $MONERO_VER != "" ]]&& check_Monero
	[[ $XMRIG_VER != "" ]]&& check_XMRig
	[[ $P2POOL_VER != "" ]]&& check_P2Pool
    if [[ $updateFound = "true" ]]; then
        echo
        $ired; echo -n "monero-bash upgrade "
        $white; echo "to upgrade all"
        $white; echo -n "or: "
        $ired; echo -n "monero-bash upgrade <name> "
        $white; echo "to upgrade something specific"
        $off
    fi
}
